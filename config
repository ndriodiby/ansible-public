
- name: Configuration Deployment
  hosts: ACI
  gather_facts: no


  tasks:

    - name: ensure tenant Customer-1 exist
      aci_tenant:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false

        tenant: AnsibleTEST
        description: AnsibleTEST
        state: absent





        - name: Configuration Deployment
  hosts: ACI
  gather_facts: no


  tasks:

    - name: create tenant AnsibleTEST
      aci_tenant:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: AnsibleTEST
        description: AnsibleTEST
        state: absent

    - name: create bridge domain
      aci_bd:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: AnsibleTEST
        bd: ansiblehosts
        state: absent

    - name: create vrf
      aci_vrf:
        host: 192.168.25.250
        username: admin 
        password: c1sc0123
        validate_certs: false
        tenant: AnsibleTEST
        vrf: ansible_vrf
        policy_control_preference: enforced
        policy_control_direction: ingress
        state: absent



- name: create syslog filter
      aci_filter:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        description:  create from ansible
        state: present
        filter: syslog

    - name: create syslog filter entry       
       
      aci_filter_entry:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        description: create from ansible
        state: present
        filter: syslog
        name: syslog
        dst_port: 514
        ip_protocol: tcp
        ether_type: ip



 name: create a contract
      aci_contract:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        contract: syslog-contract
        description:  created from ansible
        scope: tenant
        state: present
        

    - name: create a contract subject      
       
      aci_contract_subject:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        contract: syslog-contract
        subject: syslog-contract-subject
        priority: unspecified
        dscp: unspecified
        reverse_filter: yes
        description: created from ansible
        state: present




    - name: binding filter to a contract subject

      aci_contract_subject_to_filter:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        contract: syslog-contract
        subject: syslog-contract-subject
        filter: syslog
        state: present



    - name: create syslog filter entry IP range      
       
      aci_filter_entry:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        description: create from ansible
        state: present
        filter: syslog
        name: syslog-range
        dst_port_start: 8000
        dst_port_end: 8990
        ip_protocol: tcp
        ether_type: ip


    - name: create syslog filter entry       
       
      aci_filter_entry:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        description: create from ansible
        state: present
        filter: syslog
        name: syslog
        dst_port: 514
        ip_protocol: tcp
        ether_type: ip


    - name: biding provider contract to epg-1

      aci_epg_to_contract:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        contract: syslog-contract
        ap: Application-Profile-Customer-1
        epg: EPG-1
        contract_type: provider


    - name: biding consumer contract to epg5

      aci_epg_to_contract:
        host: 192.168.25.250
        username: admin
        password: c1sc0123
        validate_certs: false
        tenant: Customer-1
        contract: syslog-contract
        ap: Application-Profile-Customer-1
        epg: EPG5
        contract_type: consumer





        - name: network configuration automation deployment
  hosts: CSR1000V
  gather_facts: no


  tasks:

    - name: CSR1000V configuration deployment
      ios_config:
        src: "~/Network-Automation/Scripts/Ansible/CSR1.txt"




- hosts: CSR1000V_2
  gather_facts: no

  tasks:

    - name: CSR1000_2 configuration deployment
      ios_config:
        src: "~/Network-Automation/Scripts/Ansible/CSR2.txt"





          - ip add 1.1.1.1 255.255.255.255
          - exit
          - int lo1
          - ip add 2.1.1.1 255.255.255.255
          - exit
          - int lo2
          - ip add 3.1.1.1 255.255.255.255
          - exit
          - router ospf 1
          - router-id 3.1.1.1
          - network 192.168.25.0 0.0.0.255 area 0
          - network 1.1.1.1 0.0.0.0 area 0
          - network 2.1.1.1 0.0.0.0 area 0
          - network 3.1.1.1 0.0.0.0 area 0




          - ip tacacs source-interface gigabitEthernet1
          - aaa new-model
          - tacacs server ISE
          - address ipv4 192.168.50.250
          - key c1sc0123
          - timeout 3
          - aaa group server tacacs+ ISE-SERVER
          - sercer name ISE
          - ip tacacs source-interface gigabitEthernet1
          - aaa authentication login default group ISE-SERVER local
          - aaa authentication enable default group ISE-SERVER enable
          - aaa authorization exec default group ISE-SERVER if-authenticated
          - aaa accounting exec default start-stop group ISE-SERVER
          - aaa accounting commands 1 default start-stop group ISE-SERVER
          - aaa accounting commands 15 default start-stop group ISE-SERVER





          tasks:

    - name: allow inside to dmz
      panos_security_rule:
        ip_address: '192.168.25.40'
        username: 'admin'
        password: 'C1sc0123@'
        rule_name: 'allow inside traffic to dmz'
        from_zone: ['Inside']
        to_zone: ['Dmz']
        source: ['any']
        source_user: ['any']
        destination: ['any']
        category: ['any']
        application: ['any']
        service: ['any']
        hip_profiles: ['any']
        action: 'allow'
        commit: false





- name: Network configuration Automation
  hosts: Nexus9300
  gather_facts: no


  tasks:

    - name: create vlans 10-15 and 80,50,55-58
      ios_config:
        commands:
        - vlan 10-15,80,50,55-58

    - name: trunk port configuration on eth1 & eth2 
      ios_config:
        commands:
        - switchport trunk encapsulation dot1q
        - switchport mode trunk
        - switchport trunk allowed vlan 10-15,80,50
        - no shut
        parents: "{{ item }}"
      with_items:
        - int ethernet1/1
        - int ethernet1/2


    - name: configure vlan 80 on switchport eth1/3
      ios_config:
        commands:
          - switchport mode access
          - switchport access vlan 80
          - spanning-tree portfast
          - no shut
        parents: "{{ item }}"
      with_items:
        - int ethernet1/3





- hosts: Nexus9300_2
  gather_facts: no


  tasks:

    - name: create vlans 10-15 and 80,50,55-58
      ios_config:
        commands:
          - vlan 10-15,80,50,55-58

    - name: trunk port configuration on eth1 & eth2
      ios_config:
        commands:
          - switchport trunk encapsulation dot1q
          - switchport mode trunk
          - switchport trunk allowed vlan 10-15,80,50
          - no shut
        parents: "{{ item }}"
      with_items:
        - int ethernet1/1
        - int ethernet1/2


    - name: configure vlan 80 on switchport eth1/3
      ios_config:
        commands:
          - switchport mode access
          - switchport access vlan 80
          - spannning-tree portfast
          - no shut
        parents: "{{ item }}"
      with_items:
        - int ethernet1/3












        paloalto automation error with ansible:

        fatal: [PA-VM]: FAILED! => {"changed": false, "msg": "Missing required library \"pandevice\"."}

        install the following module to fix the issue:


        [root@localhost ~]# dnf install python3-devel

        [root@localhost ~]# yum groupinstall 'development tools'

        [admin123@localhost Ansible]$ pip-3.6 install --user pan-python

        [admin123@localhost Ansible]$ pip-3 install --user pandevice 

        [admin123@localhost Ansible]$ pip-3 install --user 
        xmltodict

        [admin123@localhost Ansible]$ pip-3.6 install --user pan-os-python



         
         192.168.10.3 (PA-VM-3)
        'success'><result><key>LUFRPT1ONklQVmZBYTNLa3kreE9iRUNvQzNzRGxUenM9ZW5JMkJ4RXVZaWE5VjcrWXhGaWZvZjVjOTh4Z2NVQTN1ZEdPOFFUaXI4bHN6N09Jb3pia0RmTFpwd2YwdlE0dw==</key></result></response>

         192.168.25.41 (PA-VM-41)
        api_key: 'LUFRPT1McGYzZWdlNFhPem9xSHBjcTVUZURlbTNUeWs9ZW5JMkJ4RXVZaWE5VjcrWXhGaWZvYXJQYVJiaHFYTEJvNHczZVhDQXYrdXZvaXIxM3BLUWl2Z1ZMd0xjS0tBUA=='


        192.168.10.4
        LUFRPT02Nmk2TVFpZFFPVnFWQnlleCtIRkt4U3RVMm89ZW5JMkJ4RXVZaWE5VjcrWXhGaWZvWUxqbmpMQUtoTFYzVXh3VnhNQmV3cXpCTS9nbFd3MnBEa20yVVJSQVZZag==